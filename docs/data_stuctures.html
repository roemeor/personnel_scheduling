---

title: Data Structures for Personnel Scheduling


keywords: fastai
sidebar: home_sidebar



nb_path: "00_data_stuctures.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 00_data_stuctures.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Helper-Functions">Helper Functions<a class="anchor-link" href="#Helper-Functions"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_work" class="doc_header"><code>is_work</code><a href="https://github.com/roemeor/personnel_scheduling/tree/master/personnel_scheduling/data_structures.py#L442" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_work</code>(<strong><code>activity_type</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_end_period_block" class="doc_header"><code>get_end_period_block</code><a href="https://github.com/roemeor/personnel_scheduling/tree/master/personnel_scheduling/data_structures.py#L449" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_end_period_block</code>(<strong><code>start_period_block</code></strong>, <strong><code>length_block</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_next_period" class="doc_header"><code>get_next_period</code><a href="https://github.com/roemeor/personnel_scheduling/tree/master/personnel_scheduling/data_structures.py#L452" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_next_period</code>(<strong><code>p</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data-Structures-for-shift-schedules">Data Structures for shift schedules<a class="anchor-link" href="#Data-Structures-for-shift-schedules"> </a></h2><p>The following data structures are used to represent activity blocks, work blocks and shifts; they are hierarchically structured as follows:</p>
<ul>
<li>an acitivty block consists of an activity type and a period of time in which this activity is assigned in a shift</li>
<li>a work block is a block of consecutive work activities </li>
<li>a shift contains all activity blocks and work and break blocks constituting a full shift</li>
<li>a shift schedule is a set of shifts that, in a typcial (multiactivity) shift scheduling problem, constitutes a solution.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Activity-Blocks">Activity Blocks<a class="anchor-link" href="#Activity-Blocks"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ActivityBlock" class="doc_header"><code>class</code> <code>ActivityBlock</code><a href="https://github.com/roemeor/personnel_scheduling/tree/master/personnel_scheduling/data_structures.py#L44" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ActivityBlock</code>(<strong><code>start_period</code></strong>:<code>int</code>, <strong><code>end_period</code></strong>:<code>int</code>, <strong><code>activity_type</code></strong>:<code>str</code>)</p>
</blockquote>
<p>ActivityBlock(start_period: int, end_period: int, activity_type: str)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">activity_block</span> <span class="o">=</span> <span class="n">ActivityBlock</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>

<span class="n">activity_block</span><span class="o">.</span><span class="n">is_work</span><span class="p">()</span>

<span class="n">activity_block</span><span class="o">.</span><span class="n">get_number_of_work_periods</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>3</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">same_activity_block</span> <span class="o">=</span> <span class="n">ActivityBlock</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>

<span class="n">activity_block</span> <span class="o">==</span> <span class="n">same_activity_block</span>

<span class="n">dict_activity_block</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">dict_activity_block</span><span class="p">[</span><span class="n">activity_block</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">dict_activity_block</span><span class="p">[</span><span class="n">same_activity_block</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">dict_activity_block</span><span class="p">[</span><span class="n">activity_block</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>2</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_activity_blocks_from_list_or_array" class="doc_header"><code>create_activity_blocks_from_list_or_array</code><a href="https://github.com/roemeor/personnel_scheduling/tree/master/personnel_scheduling/data_structures.py#L506" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_activity_blocks_from_list_or_array</code>(<strong><code>activity_list</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Work-Blocks">Work Blocks<a class="anchor-link" href="#Work-Blocks"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="WorkBlock" class="doc_header"><code>class</code> <code>WorkBlock</code><a href="https://github.com/roemeor/personnel_scheduling/tree/master/personnel_scheduling/data_structures.py#L124" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>WorkBlock</code>(<strong><code>activity_blocks</code></strong>:<code>list</code>=<em><code>&lt;factory&gt;</code></em>)</p>
</blockquote>
<p>WorkBlock(activity_blocks: list = <factory>)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>    
<span class="n">activity_blocks</span> <span class="o">=</span> <span class="p">[</span><span class="n">ActivityBlock</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">ActivityBlock</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)]</span>
    
<span class="n">work_block</span> <span class="o">=</span> <span class="n">WorkBlock</span><span class="p">(</span><span class="n">activity_blocks</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">work_block</span><span class="o">.</span><span class="n">get_number_of_work_periods</span><span class="p">())</span>

<span class="n">work_block</span><span class="o">.</span><span class="n">get_list_representation</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>5
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[1, 1, 1, 2, 2]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_work_blocks_from_activity_blocks" class="doc_header"><code>create_work_blocks_from_activity_blocks</code><a href="https://github.com/roemeor/personnel_scheduling/tree/master/personnel_scheduling/data_structures.py#L575" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_work_blocks_from_activity_blocks</code>(<strong><code>activity_blocks</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We should be able to read also if there is not "break, but empty space"</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">activity_blocks</span> <span class="o">=</span> <span class="n">create_activity_blocks_from_list_or_array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;break&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="n">create_work_blocks_from_activity_blocks</span><span class="p">(</span><span class="n">activity_blocks</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[WorkBlock(activity_blocks=[ActivityBlock(start_period=0, end_period=2, activity_type=1)]),
 ActivityBlock(start_period=3, end_period=3, activity_type=&#39;break&#39;),
 WorkBlock(activity_blocks=[ActivityBlock(start_period=4, end_period=5, activity_type=2)])]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Shifts">Shifts<a class="anchor-link" href="#Shifts"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Shift" class="doc_header"><code>class</code> <code>Shift</code><a href="https://github.com/roemeor/personnel_scheduling/tree/master/personnel_scheduling/data_structures.py#L187" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Shift</code>(<strong><code>activity_blocks</code></strong>:<code>list</code>=<em><code>&lt;factory&gt;</code></em>, <strong><code>work_and_break_blocks</code></strong>:<code>list</code>=<em><code>&lt;factory&gt;</code></em>)</p>
</blockquote>
<p>Shift(activity_blocks: list = <factory>, work_and_break_blocks: list = <factory>)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="ShiftSchedule">ShiftSchedule<a class="anchor-link" href="#ShiftSchedule"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="turn_string_to_activity_number" class="doc_header"><code>turn_string_to_activity_number</code><a href="https://github.com/roemeor/personnel_scheduling/tree/master/personnel_scheduling/data_structures.py#L681" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>turn_string_to_activity_number</code>(<strong><code>activity</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ShiftSchedule" class="doc_header"><code>class</code> <code>ShiftSchedule</code><a href="https://github.com/roemeor/personnel_scheduling/tree/master/personnel_scheduling/data_structures.py#L273" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ShiftSchedule</code>(<strong><code>shifts</code></strong>:<code>list</code>=<em><code>&lt;factory&gt;</code></em>)</p>
</blockquote>
<p>ShiftSchedule(shifts: list = <factory>)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">shift_schedule</span> <span class="o">=</span> <span class="n">ShiftSchedule</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;test_data/sol1.csv&quot;</span><span class="p">)</span>

<span class="n">shift_schedule</span><span class="o">.</span><span class="n">write_to_csv</span><span class="p">(</span><span class="s2">&quot;test_data/sol2.csv&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Rule-Related-Data-Structures-and-Functions">Rule-Related Data Structures and Functions<a class="anchor-link" href="#Rule-Related-Data-Structures-and-Functions"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Below, we provide some data structures for providing a unified treatment of rule checking and reporting.</p>
<p>First, we have a namded tuple called <a href="/personnel_scheduling/data_stuctures.html#Penalty"><code>Penalty</code></a> which simply forms a tuple of a string with a rule name and a numerical value (a penalty).</p>
<p>Then, there is a class called <a href="/personnel_scheduling/data_stuctures.html#RuleEvaluationResult"><code>RuleEvaluationResult</code></a>. The attributes of this class are:</p>
<ul>
<li>a list of strings with hard rule violations</li>
<li>a list of Penalty-objects.</li>
</ul>
<p>This class can be used on different levels. We can</p>
<ul>
<li>explicitly add a hard rule violation or a penalty</li>
<li>add another RuleEvaluationResult (this way, we can, for example compute the results for multiple shifts and combine them for a full shift schedule.</li>
</ul>
<p>Then, there are various functions for computing total penalties and data frames that list details about the different penality types.</p>
<p><strong>TODO: We should create a small example rule set and a small schedule that we can use here as a dummy example</strong></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="RuleEvaluationResult" class="doc_header"><code>class</code> <code>RuleEvaluationResult</code><a href="https://github.com/roemeor/personnel_scheduling/tree/master/personnel_scheduling/data_structures.py#L334" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>RuleEvaluationResult</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following function takes a schedule and a rule set and returns an EvaluationResults-Object.</p>
<p>Note that the rule_set is a class that needs to be implemented for a given problem type / instance-set. The rule_set needs to implement all the methods that are called below, namely:</p>
<ul>
<li>check_activity_block_rules</li>
<li>check_work_block_rules</li>
<li>check_shift_rules</li>
<li>check_demand_coverage</li>
</ul>
<p>At the moment, this package contains two implementations of such rule sets, for the Demassey-instances and for the Dahmen-instances.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="evaluate_shift_schedule" class="doc_header"><code>evaluate_shift_schedule</code><a href="https://github.com/roemeor/personnel_scheduling/tree/master/personnel_scheduling/data_structures.py#L785" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>evaluate_shift_schedule</code>(<strong><code>shift_schedule</code></strong>, <strong><code>rule_set</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Below two helper functions for computing covered demands.</p>
<p>They assume that the instance object has the two attributes <code>number_of_periods</code> and <code>number_of_activities</code></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_covered_activity_demands_per_period" class="doc_header"><code>get_covered_activity_demands_per_period</code><a href="https://github.com/roemeor/personnel_scheduling/tree/master/personnel_scheduling/data_structures.py#L815" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_covered_activity_demands_per_period</code>(<strong><code>shift_schedule</code></strong>, <strong><code>instance</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_covered_aggregate_demand_per_period" class="doc_header"><code>get_covered_aggregate_demand_per_period</code><a href="https://github.com/roemeor/personnel_scheduling/tree/master/personnel_scheduling/data_structures.py#L829" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_covered_aggregate_demand_per_period</code>(<strong><code>shift_schedule</code></strong>, <strong><code>instance</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Exporting">Exporting<a class="anchor-link" href="#Exporting"> </a></h2>
</div>
</div>
</div>
</div>
 

